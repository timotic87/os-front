<div class="container mx-auto p-6 pt-20 dark:bg-gray-600 h-full">
  <div class="historySVG">
    <svg fill="#ffad33" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
         width="24px" height="24px" viewBox="0 0 31.289 31.288"><g id="SVGRepo_bgCarrier" stroke-width="0"></g>
      <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#CCCCCC" stroke-width="0.375468"></g>
      <g id="SVGRepo_iconCarrier"> <g> <g> <path d="M28.327,13.357v-1.735l-0.25-0.099c-0.079-0.031-1.804-0.698-4.188-0.808v0.792c1.729,0.085,3.104,0.483,3.646,0.663 v16.084c-1.117-0.449-2.403-0.676-3.827-0.676c-3.489,0-6.812,1.338-7.812,1.777v-6.39l0.465,0.513v-4.58h-1.191v4.58l0.465-0.513 v6.398c-1.013-0.419-4.5-1.745-7.993-1.745c-1.381,0-2.603,0.212-3.645,0.63v-16.08c0.608-0.203,2.264-0.682,4.305-0.682 c0.146,0,0.288,0.012,0.434,0.017v-0.789c-0.146-0.004-0.288-0.017-0.434-0.017c-2.721,0-4.76,0.792-4.844,0.825l-0.25,0.099 v1.607c-0.823,0.154-1.335,0.431-1.335,0.88c0,2.342,0,16.562,0,16.562h12.196c0.422,0.376,1.038,0.617,1.729,0.617 c0.691,0,1.308-0.24,1.729-0.617h11.889c0,0,0-15.739,0-16.562C29.416,13.742,29.001,13.504,28.327,13.357z"></path> <polygon points="24.505,5.806 7.774,5.806 7.774,6.861 9.411,6.861 9.411,15.41 11.047,15.41 11.047,6.861 13.159,6.861 13.159,15.41 14.794,15.41 14.794,6.861 17.539,6.861 17.539,15.41 19.175,15.41 19.175,6.861 21.286,6.861 21.286,15.41 22.921,15.41 22.921,6.861 24.505,6.861 "></polygon> <polygon points="16.273,0 6.932,5.317 25.455,5.317 "></polygon> <polygon points="24.505,15.727 23.845,15.727 8.702,15.727 7.934,15.727 7.934,16.939 7.353,16.939 7.353,18.155 25.193,18.155 25.193,16.939 24.505,16.939 24.505,16.333 "></polygon> </g> </g> </g></svg>
  </div>
  <div *ngIf="deal">
    <app-color-label>Created by {{ deal.creator.firstName+' '+ deal.creator.lastName}}
      {{ deal.createdDate | date: 'MMM d, y' }} at {{ deal.createdDate | date: 'h:mm a' }}
    </app-color-label>
    <div class="text-l mt-6">
      This project is created on <span class="text-[#386097] dark:text-[#56BDED]">{{ deal.legalEntity.name }}</span>
    </div>
    <div class="text-l mt-6">
      <span class="inline-block">BD consultant:</span>
      <span class="ml-1 text-[#386097] dark:text-[#56BDED]">{{ deal.BDOwner.firstName+' '+ deal.BDOwner.lastName }}</span>
    </div>
    <div class="my-6 font-bold">
      <span class="mr-9">Service: <span
        class="text-[#386097] dark:text-[#56BDED]">{{ deal.service.name }}</span></span>Subservice: <span
      class="text-[#386097] dark:text-[#56BDED]">{{ deal.subservice.name }}</span>
    </div>
    <div class="grid grid-cols-2 xl:grid-cols-3 gap-2 pr-2 py-2">
      <div class="border-2 border-[#386097] dark:border-[#56BDED] p-3 rounded-lg col-span-2">
        <h2 class="text-xl mb-3">Client: <span
          class="text-[#386097] dark:text-[#56BDED] font-bold">{{ deal.client.name }}</span></h2>
        <p class="mb-3">Country:
          <span
          class="text-[#386097] dark:text-[#56BDED] mr-6">{{ deal.client.country.name }}</span>
          City: <span
          class="text-[#386097] dark:text-[#56BDED] mr-6">{{ deal.client.city }}</span>
          Address: <span class="text-[#386097] dark:text-[#56BDED] mr-3">{{ deal.client.address }}</span></p>
        <p class="mb-3">Mail: <span
          class="text-[#386097] dark:text-[#56BDED] mr-6">{{ deal.client.mail ? deal.client.mail : 'Email address missing' }}</span>
          Number: <span class="text-[#386097] dark:text-[#56BDED] mr-6">{{ 'xxxxxxx' }}</span></p>
        <p class="mb-3">Mail for finance: <span
          class="text-[#386097] dark:text-[#56BDED] mr-6">{{ deal.client.mail ? deal.client.mail : 'Email address missing' }}</span>
          Number for finance: <span class="text-[#386097] dark:text-[#56BDED] mr-6">{{ 'xxxxxxx' }}</span></p>
      </div>
      <div class="border-2 border-[#386097] dark:border-[#56BDED] p-3 rounded-lg col-span-2 xl:col-span-1">
        <div class="flex items-start gap-2.5 mt-3" *ngIf="lastComment">
          @if (lastComment.creator.profilePicUrl){
            <img class="w-8 h-8 rounded-full" [src]=lastComment.creator.profilePicUrl alt="user img" style="object-fit: cover;">
          } @else {
            <img class="w-8 h-8 rounded-full" src='./assets/profile.png' alt="user img" style="object-fit: cover;">
          }
          <div
            class="commentWraper flex flex-col w-full max-w-[320px] leading-1.5 p-4 border-gray-200 bg-gray-100 rounded-e-xl rounded-es-xl dark:bg-gray-700">
            <div class="flex items-center space-x-2 rtl:space-x-reverse">
              <span
                class="text-sm font-semibold text-gray-900 dark:text-white">{{ lastComment.creator.firstName+' '+lastComment.creator.lastName }}</span>
              <span
                class="text-sm font-normal text-gray-500 dark:text-gray-400">{{ lastComment.createdDate | date:'dd.MM.yyyy HH:mm' }}</span>
            </div>
            <p
              class="commentText text-sm font-normal pt-2.5 text-gray-900 dark:text-white">{{ lastComment.comment }}</p>
          </div>
        </div>

        <div class="flex flex-column justify-end" *ngIf="lastComment">
          <div class="hover:cursor-pointer w-8 mr-2 transform hover:text-[#386097] dark:hover:text-[#56BDED] hover:scale-110 inline-block" (click)="openComment()" >
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M8.625 9.75a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375m-13.5 3.01c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.184-4.183a1.14 1.14 0 0 1 .778-.332 48.294 48.294 0 0 0 5.83-.498c1.585-.233 2.708-1.626 2.708-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z" />
            </svg>
          </div>
        </div>

        <div *ngIf="!lastComment">
          @if (getCommentPerm){
            <p>No comment yet!</p>
          } @else {
            <p>You don't have permission to see comments!</p>
          }

          <button (click)="openComment();" [disabled]="!getCommentPerm"
                  class="hover:cursor-pointer my-5 middle none center mr-4 rounded-lg bg-[#386097]
    py-3 px-6 font-sans text-xs font-bold uppercase text-white
    shadow-md shadow-blue-500/20 transition-all hover:shadow-lg
    hover:shadow-blue-500/40 focus:opacity-[0.85]
    focus:shadow-none active:opacity-[0.85] active:shadow-none
    disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none dark:bg-[#56BDED]"
                  data-ripple-light="true">Add new comment
          </button>
        </div>

      </div>
    </div>
  </div>
  <app-stuffing-flow *ngIf="!!deal && deal.subservice.typeID===2" [deal]="deal"></app-stuffing-flow>
</div>

<!--    <app-py-flow [project]="deal" *ngIf="deal.subservice.typeID===3"></app-py-flow>-->


